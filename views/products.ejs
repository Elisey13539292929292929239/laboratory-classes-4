<h1>Produkty</h1>

<ul>
  <% products.forEach(product => { %>
    <li>
      <strong><%= product.name %></strong> – <%= product.description %>
      |
      <a href="/products/<%= product.name %>">Details</a>
      |
      <button onclick="deleteProduct('<%= product.name %>')">Delete</button>
    </li>
  <% }) %>
</ul>

<script>
  function deleteProduct(name) {
    fetch(`/products/${encodeURIComponent(name)}`, {
      method: 'DELETE'
    })
    .then(response => {
      if (response.ok) {
        location.reload();
      } else {
        alert("Nie udało się usunąć produktu.");
      }
    })
    .catch(err => {
      console.error("Błąd:", err);
      alert("Wystąpił błąd.");
    });
  }
</script>
